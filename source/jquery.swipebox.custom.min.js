(function(b,a,c,d){c.swipebox=function(g,t){var k={useCSS:true,initialIndexOnArray:0,hideBarsDelay:3000,videoMaxWidth:1140,vimeoColor:"CCCCCC",beforeOpen:null,afterClose:null,actionsOnTop:false},p=this,e=[],g=g,h=g.selector,s=c(h),l=a.createTouch!==d||("ontouchstart" in b)||("onmsgesturechange" in b)||navigator.msMaxTouchPoints,n=!!(b.SVGSVGElement),f=b.innerWidth?b.innerWidth:c(b).width(),j=b.innerHeight?b.innerHeight:c(b).height(),m="#swipebox-header",r="#swipebox-footer",o='<div id="swipebox-overlay">				<div id="swipebox-slider"></div>				<div id="swipebox-header"></div>				<div id="swipebox-footer"></div>		        </div>',i='<a id="swipebox-close"></a>					<a id="swipebox-prev"></a>					<a id="swipebox-next"></a>';p.settings={};p.init=function(){p.settings=c.extend({},k,t);if(c.isArray(g)){e=g;q.target=c(b);q.init(p.settings.initialIndexOnArray)}else{s.click(function(w){e=[];var u,v,x;if(!x){v="rel";x=c(this).attr(v)}if(x&&x!==""&&x!=="nofollow"){$elem=s.filter("["+v+'="'+x+'"]')}else{$elem=c(h)}$elem.each(function(){var z=null,y=null;if(c(this).attr("title")){z=c(this).attr("title")}if(c(this).attr("href")){y=c(this).attr("href")}e.push({href:y,title:z})});u=$elem.index(c(this));w.preventDefault();w.stopPropagation();q.target=c(w.target);q.init(u)})}};p.refresh=function(){if(!c.isArray(g)){q.destroy();$elem=c(h);q.actions()}};var q={init:function(u){if(p.settings.beforeOpen){p.settings.beforeOpen()}this.target.trigger("swipebox-start");c.swipebox.isOpen=true;this.build();this.openSlide(u);this.openMedia(u);this.preloadMedia(u+1);this.preloadMedia(u-1)},build:function(){var v=this;c("body").append(o);if(p.settings.actionsOnTop){r="#swipebox-header";m="#swipebox-footer"}c(r).html(i);if(v.doCssTrans()){c("#swipebox-slider").css({"-webkit-transition":"left 0.4s ease","-moz-transition":"left 0.4s ease","-o-transition":"left 0.4s ease","-khtml-transition":"left 0.4s ease",transition:"left 0.4s ease"});c("#swipebox-overlay").css({"-webkit-transition":"opacity 1s ease","-moz-transition":"opacity 1s ease","-o-transition":"opacity 1s ease","-khtml-transition":"opacity 1s ease",transition:"opacity 1s ease"});c("#swipebox-footer, #swipebox-header").css({"-webkit-transition":"0.5s","-moz-transition":"0.5s","-o-transition":"0.5s","-khtml-transition":"0.5s",transition:"0.5s"})}if(n){var u=c("#swipebox-close").css("background-image");u=u.replace("png","svg");c("#swipebox-prev,#swipebox-next,#swipebox-close").css({"background-image":u})}c.each(e,function(){c("#swipebox-slider").append('<div class="slide"></div>')});v.setDim();v.actions();v.keyboard();v.gesture();v.animBars();v.resize()},setDim:function(){var w,u,v={};if("onorientationchange" in b){b.addEventListener("orientationchange",function(){if(b.orientation==0){w=f;u=j}else{if(b.orientation==90||b.orientation==-90){w=j;u=f}}},false)}else{w=b.innerWidth?b.innerWidth:c(b).width();u=b.innerHeight?b.innerHeight:c(b).height()}v={width:w,height:u};c("#swipebox-overlay").css(v)},resize:function(){var u=this;c(b).resize(function(){u.setDim()}).resize()},supportTransition:function(){var v="transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" ");for(var u=0;u<v.length;u++){if(a.createElement("div").style[v[u]]!==d){return v[u]}}return false},doCssTrans:function(){if(p.settings.useCSS&&this.supportTransition()){return true}},gesture:function(){if(l){var y=this,z=null,x=10,w={},u={};var v=c("#swipebox-header, #swipebox-footer");v.addClass("visible-bars");y.setTimeout();c("body").bind("touchstart",function(A){c(this).addClass("touching");u=A.originalEvent.targetTouches[0];w.pageX=A.originalEvent.targetTouches[0].pageX;c(".touching").bind("touchmove",function(B){B.preventDefault();B.stopPropagation();u=B.originalEvent.targetTouches[0]});return false}).bind("touchend",function(A){A.preventDefault();A.stopPropagation();z=u.pageX-w.pageX;if(z>=x){y.getPrev()}else{if(z<=-x){y.getNext()}else{if(!v.hasClass("visible-bars")){y.showBars();y.setTimeout()}else{y.clearTimeout();y.hideBars()}}}c(".touching").off("touchmove").removeClass("touching")})}},setTimeout:function(){if(p.settings.hideBarsDelay>0){var u=this;u.clearTimeout();u.timeout=b.setTimeout(function(){u.hideBars()},p.settings.hideBarsDelay)}else{c("#swipebox-slider .slide").css({paddingTop:c("#swipebox-header").height(),paddingBottom:c("#swipebox-footer").height()})}},clearTimeout:function(){b.clearTimeout(this.timeout);this.timeout=null},showBars:function(){var u=c("#swipebox-header, #swipebox-footer");if(this.doCssTrans()){u.addClass("visible-bars")}else{c("#swipebox-header").animate({top:0},500);c("#swipebox-footer").animate({bottom:0},500);setTimeout(function(){u.addClass("visible-bars")},1000)}},hideBars:function(){var u=c("#swipebox-header, #swipebox-footer");if(this.doCssTrans()){u.removeClass("visible-bars")}else{c("#swipebox-header").animate({top:"-50px"},500);c("#swipebox-footer").animate({bottom:"-50px"},500);setTimeout(function(){u.removeClass("visible-bars")},1000)}},animBars:function(){var v=this;var u=c("#swipebox-header, #swipebox-footer");u.addClass("visible-bars");v.setTimeout();c("#swipebox-slider").click(function(w){if(!u.hasClass("visible-bars")){v.showBars();v.setTimeout()}});c(r).hover(function(){v.showBars();u.addClass("force-visible-bars");v.clearTimeout()},function(){u.removeClass("force-visible-bars");v.setTimeout()})},keyboard:function(){var u=this;c(b).bind("keyup",function(v){v.preventDefault();v.stopPropagation();if(v.keyCode==37){u.getPrev()}else{if(v.keyCode==39){u.getNext()}else{if(v.keyCode==27){u.closeSlide()}}}})},actions:function(){var u=this;if(e.length<2){c("#swipebox-prev, #swipebox-next").hide()}else{c("#swipebox-prev").bind("click touchend",function(v){v.preventDefault();v.stopPropagation();u.getPrev();u.setTimeout()});c("#swipebox-next").bind("click touchend",function(v){v.preventDefault();v.stopPropagation();u.getNext();u.setTimeout()})}c("#swipebox-close").bind("click touchend",function(v){u.closeSlide()})},setSlide:function(v,u){u=u||false;var w=c("#swipebox-slider");if(this.doCssTrans()){w.css({left:(-v*100)+"%"})}else{w.animate({left:(-v*100)+"%"})}c("#swipebox-slider .slide").removeClass("current");c("#swipebox-slider .slide").eq(v).addClass("current");this.setTitle(v);if(u){w.fadeIn()}c("#swipebox-prev, #swipebox-next").removeClass("disabled");if(v==0){c("#swipebox-prev").addClass("disabled")}else{if(v==e.length-1){c("#swipebox-next").addClass("disabled")}}},openSlide:function(u){c("html").addClass("swipebox");c(b).trigger("resize");this.setSlide(u,true)},preloadMedia:function(u){var v=this,w=null;if(e[u]!==d){w=e[u].href}if(!v.isVideo(w)){setTimeout(function(){v.openMedia(u)},1000)}else{v.openMedia(u)}},openMedia:function(u){var v=this,w=null;if(e[u]!==d){w=e[u].href}if(u<0||u>=e.length){return false}if(!v.isVideo(w)){v.loadMedia(w,function(){c("#swipebox-slider .slide").eq(u).html(this)})}else{c("#swipebox-slider .slide").eq(u).html(v.getVideo(w))}},setTitle:function(v,u){var w=null;c(m).empty();if(e[v]!==d){w=e[v].title}if(w){c(m).append(w)}},isVideo:function(u){if(u){if(u.match(/youtube\.com\/watch\?v=([a-zA-Z0-9\-_]+)/)||u.match(/vimeo\.com\/([0-9]*)/)){return true}}},getVideo:function(w){var x="";var v="";var u=w.match(/watch\?v=([a-zA-Z0-9\-_]+)/);var y=w.match(/vimeo\.com\/([0-9]*)/);if(u){x='<iframe width="560" height="315" src="//www.youtube.com/embed/'+u[1]+'" frameborder="0" allowfullscreen></iframe>'}else{if(y){x='<iframe width="560" height="315"  src="http://player.vimeo.com/video/'+y[1]+"?byline=0&amp;portrait=0&amp;color="+p.settings.vimeoColor+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}}return'<div class="swipebox-video-container" style="max-width:'+p.settings.videomaxWidth+'px"><div class="swipebox-video">'+x+"</div></div>"},loadMedia:function(v,w){if(!this.isVideo(v)){var u=c("<img>").on("load",function(){w.call(u)});u.attr("src",v)}},getNext:function(){var u=this;index=c("#swipebox-slider .slide").index(c("#swipebox-slider .slide.current"));if(index+1<e.length){index++;u.setSlide(index);u.preloadMedia(index+1)}else{c("#swipebox-slider").addClass("rightSpring");setTimeout(function(){c("#swipebox-slider").removeClass("rightSpring")},500)}},getPrev:function(){index=c("#swipebox-slider .slide").index(c("#swipebox-slider .slide.current"));if(index>0){index--;this.setSlide(index);this.preloadMedia(index-1)}else{c("#swipebox-slider").addClass("leftSpring");setTimeout(function(){c("#swipebox-slider").removeClass("leftSpring")},500)}},closeSlide:function(){c("html").removeClass("swipebox");c(b).trigger("resize");this.destroy()},destroy:function(){c(b).unbind("keyup");c("body").unbind("touchstart");c("body").unbind("touchmove");c("body").unbind("touchend");c("#swipebox-slider").unbind();c("#swipebox-overlay").remove();if(!c.isArray(g)){g.removeData("_swipebox")}if(this.target){this.target.trigger("swipebox-destroy")}c.swipebox.isOpen=false;if(p.settings.afterClose){p.settings.afterClose()}}};p.init()};c.fn.swipebox=function(f){if(!c.data(this,"_swipebox")){var e=new c.swipebox(this,f);this.data("_swipebox",e)}return this.data("_swipebox")}}(window,document,jQuery));